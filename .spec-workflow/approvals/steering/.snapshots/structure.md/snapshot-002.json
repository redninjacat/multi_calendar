{
  "id": "snapshot_1769788331103_wvxhg3uu9",
  "approvalId": "approval_1769659925601_62t69xq2v",
  "approvalTitle": "Structure Steering Document - Multi Calendar Package",
  "version": 2,
  "timestamp": "2026-01-30T15:52:11.103Z",
  "trigger": "approved",
  "status": "pending",
  "content": "# Project Structure\n\n## Directory Organization\n\n```\nmulti_calendar/\n├── lib/\n│   ├── src/\n│   │   ├── models/              # Event data models\n│   │   │   ├── calendar_event.dart\n│   │   │   ├── rrule_data.dart\n│   │   │   └── event_exception.dart\n│   │   ├── views/                # Calendar view widgets\n│   │   │   ├── day_view.dart\n│   │   │   ├── multi_day_view.dart\n│   │   │   └── month_view.dart\n│   │   ├── controllers/          # Event controller\n│   │   │   └── event_controller.dart\n│   │   ├── widgets/              # Shared widgets\n│   │   │   ├── event_tile.dart\n│   │   │   ├── time_slot.dart\n│   │   │   ├── day_header.dart\n│   │   │   ├── navigator.dart    # Optional navigator widget\n│   │   │   └── current_time_indicator.dart\n│   │   ├── utils/                # Utilities\n│   │   │   ├── rrule_parser.dart\n│   │   │   ├── date_utils.dart\n│   │   │   ├── event_expander.dart\n│   │   │   ├── localization.dart\n│   │   │   └── accessibility.dart\n│   │   └── styles/               # Style definitions\n│   │       ├── calendar_theme.dart\n│   │       └── view_styles.dart\n│   └── multi_calendar.dart       # Main export file\n├── test/\n│   ├── models/\n│   ├── views/\n│   ├── controllers/\n│   ├── utils/\n│   └── integration/\n├── example/\n│   └── lib/\n│       └── main.dart            # Example app demonstrating all views\n├── .spec-workflow/              # Spec workflow documents\n├── analysis_options.yaml\n├── CHANGELOG.md\n├── LICENSE\n├── pubspec.yaml\n└── README.md\n```\n\n## Naming Conventions\n\n### Files\n- **Widgets/Views**: `snake_case.dart` (e.g., `day_view.dart`, `event_tile.dart`)\n- **Models**: `snake_case.dart` (e.g., `calendar_event.dart`, `rrule_data.dart`)\n- **Controllers**: `snake_case.dart` (e.g., `event_controller.dart`)\n- **Utilities**: `snake_case.dart` (e.g., `date_utils.dart`, `rrule_parser.dart`)\n- **Tests**: `[filename]_test.dart` (e.g., `day_view_test.dart`)\n\n### Code\n- **Classes/Types**: `PascalCase` (e.g., `DayView`, `CalendarEvent`, `EventController`)\n- **Widgets**: `PascalCase` (e.g., `DayView`, `MultiDayView`, `MonthView`)\n- **Functions/Methods**: `camelCase` (e.g., `loadEvents`, `expandRecurrence`)\n- **Constants**: `lowerCamelCase` for public, `_lowerCamelCase` for private (e.g., `defaultTimeRange`, `_defaultTileHeight`)\n- **Variables**: `camelCase` (e.g., `startDate`, `eventList`)\n- **Private members**: Prefix with `_` (e.g., `_eventController`, `_visibleRange`)\n\n## Import Patterns\n\n### Import Order\n1. Dart SDK imports (e.g., `dart:async`, `dart:math`)\n2. Flutter SDK imports (e.g., `package:flutter/material.dart`)\n3. External package imports (e.g., `package:rrule/rrule.dart`)\n4. Internal package imports (e.g., `package:multi_calendar/src/models/calendar_event.dart`)\n\n### Module/Package Organization\n- Use `package:multi_calendar/...` for internal imports\n- Group related functionality in subdirectories\n- Main export file (`lib/multi_calendar.dart`) exports public API only\n- Internal implementation in `lib/src/` is not directly importable\n\n## Code Structure Patterns\n\n### Widget Organization\n```dart\n// 1. Imports\nimport 'package:flutter/material.dart';\nimport 'package:multi_calendar/src/models/calendar_event.dart';\n\n// 2. Class definition with documentation\n/// DayView displays events in a single day with configurable time range.\nclass DayView extends StatefulWidget {\n  // 3. Constructor with required parameters\n  const DayView({\n    required this.controller,\n    this.timeRange,\n    this.onEventTap,\n    // ...\n  });\n\n  // 4. Public properties\n  final EventController controller;\n  final TimeRange? timeRange;\n  final void Function(CalendarEvent event, DateTime dateTime)? onEventTap;\n\n  // 5. State class\n  @override\n  State<DayView> createState() => _DayViewState();\n}\n\n// 6. State implementation\nclass _DayViewState extends State<DayView> {\n  // Private fields\n  // Lifecycle methods\n  // Build method\n  // Helper methods\n}\n```\n\n### Model Organization\n```dart\n// 1. Imports\n// 2. Class definition\nclass CalendarEvent {\n  // 3. Public properties\n  // 4. Constructor\n  // 5. Factory constructors\n  // 6. Methods\n  // 7. Overrides (toString, ==, hashCode)\n}\n```\n\n### Controller Organization\n```dart\n// 1. Imports\n// 2. Class definition\nclass EventController extends ChangeNotifier {\n  // 3. Private fields\n  // 4. Public properties\n  // 5. Constructor\n  // 6. Public methods\n  // 7. Private helper methods\n}\n```\n\n## Code Organization Principles\n\n1. **Single Responsibility**: Each widget/model/controller has one clear purpose\n2. **Modularity**: Views are independent widgets that can be used separately\n3. **Testability**: Models and utilities are easily testable without Flutter dependencies\n4. **Consistency**: Follow Flutter/Dart conventions throughout\n5. **Separation of Concerns**: Display logic in views, data logic in controller, models are pure data\n\n## Module Boundaries\n\n### Public API vs Internal\n- **Public**: Exported from `lib/multi_calendar.dart`\n  - View widgets (DayView, MultiDayView, MonthView)\n  - EventController\n  - CalendarEvent model\n  - Style/theme classes\n- **Internal**: In `lib/src/` - not directly importable\n  - Implementation details\n  - Utility functions\n  - Internal widgets\n\n### View Independence\n- Each view (Day, Multi-day, Month) is a separate widget\n- Views can be used independently\n- Shared utilities in `utils/` directory\n- Common widgets in `widgets/` directory\n\n### External Integration Points\n- **EventController**: Interface for loading events from external systems\n- **Builder Callbacks**: Allow external customization of event tiles, cells, navigators, date/time labels\n- **Event Models**: Simple data classes that external systems can populate\n- **Callbacks**: onTap, onLongPress, onEventDrop, onEventResize, onHover* for external handling\n- **Cell Interactivity**: Callback to disable cell interactions (e.g., blackout days)\n- **Date Formatting**: Standard format strings or custom builders for date/time labels\n- **Localization**: Integration with app's localization system via intl package\n\n## Code Size Guidelines\n\n- **File size**: Maximum 500 lines per file (aim for 200-300)\n- **Function/Method size**: Maximum 50 lines (aim for 10-20)\n- **Widget build methods**: Keep under 100 lines, extract to helper methods\n- **Class complexity**: Maximum 10 public methods per class\n- **Nesting depth**: Maximum 4 levels of nesting\n\n## Package Structure Principles\n\n### View Widgets\n- Each view is self-contained\n- Shared styling via theme/style classes\n- Common event tile logic in shared widgets\n- View-specific logic stays in view file\n- Optional navigator widget can be included per view\n- Current time indicator for time-based views\n- Responsive layout handling (mobile-first)\n- RTL layout support built-in\n\n### Event Controller\n- Single controller handles all views\n- Manages visible date range\n- Delegates event loading to callbacks\n- Notifies listeners of changes\n\n### Models\n- Pure data classes\n- No business logic\n- Serializable for external storage\n- Immutable where possible\n\n### Utilities\n- Pure functions where possible\n- No side effects\n- Well-tested\n- Reusable across views\n- Localization helpers for date/time formatting\n- Accessibility helpers for semantic labels\n- RTL-aware layout utilities\n\n## Documentation Standards\n\n- **Public API**: All public classes, methods, properties must have dartdoc comments\n- **Complex Logic**: Inline comments for RRULE parsing, event expansion algorithms, gesture handling\n- **Examples**: Code examples in README and dartdoc\n- **README**: Comprehensive usage examples for each view, including localization, accessibility, RTL\n- **CHANGELOG**: Maintained for each release\n- **Accessibility**: Document semantic labels and accessibility features\n- **Localization**: Document supported locales and how to add new ones\n\n## Testing Structure\n\n- **Unit Tests**: For models, utilities, controllers (in `test/`)\n- **Widget Tests**: For view widgets (in `test/views/`)\n- **Integration Tests**: For full calendar workflows (in `test/integration/`)\n- **Test Coverage**: Aim for 80%+ coverage on core functionality\n- **Test Data**: Shared test fixtures in `test/fixtures/`\n- **Accessibility Tests**: Test semantic labels and screen reader compatibility\n- **Localization Tests**: Test date/time formatting, RTL layout, i18n strings\n- **Gesture Tests**: Test drag-and-drop, resize, tap, long-press interactions\n- **Platform Tests**: Test mobile and desktop-specific features (hover, etc.)\n\n## Example App Structure\n\n```\nexample/\n├── lib/\n│   ├── main.dart                 # Main app entry\n│   ├── models/                   # Example event models\n│   ├── services/                 # Example event service (mock storage)\n│   └── screens/                  # Example screens for each view\n├── pubspec.yaml                  # Example app dependencies\n└── README.md                     # Example app documentation\n```\n",
  "fileStats": {
    "size": 9327,
    "lines": 258,
    "lastModified": "2026-01-30T02:34:05.171Z"
  },
  "comments": []
}